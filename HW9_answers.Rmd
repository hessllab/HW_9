---
title: "HW9_Answers"
author: "Zack Grzywacz and Jaimee Pyron"
date: "October 31, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(markdown)
library(knitr)
library(kableExtra)
```

1. Are the data in a flat file format? 

```{r}
gap_co2 <- read.csv("./data/co2_emissions_tonnes_per_person_gapminder.csv")
```

Yes, a .csv is considered flat file format. 
# Though note that each row is not a single observation.

2. What is the structure of the data?  Are there any variables you might need to convert prior to manipulating the data?

```{r}
str(gap_co2)
```

This data is in a dataframe. All variables are numbers except for "country", which is a factor. We will convert it to a character vector.

```{r}
gap_co2$country <- as.character(gap_co2$country)
```


3. What countries had per capita emissions larger than the 95th percentile in 2014? Make a table of their names and per capita emissions. Hint: Use quantile() to find the 95% cutoff.

```{r}
quantile(gap_co2$X2014, probs = seq(0, 1, 0.05))
cutoff <- quantile(gap_co2$X2014, probs = 0.95) # then you can directly use this variable in the next step.
```

The cutoff is 15.4. We will create a data frame to fill with the countries that have 2014 emissions above this level, then create a table from this data. 

```{r}
dat <- rep("NA", 9)
topPercentile <- data.frame("Country"=dat, "PerCapEmissions.2014"=dat)
topPercentile$Country <- gap_co2$country[gap_co2$X2014 > 15.40000]
topPercentile$PerCapEmissions.2014 <- gap_co2$X2014[gap_co2$X2014 > 15.40000]
topPercentile %>%
  kable() %>%
  kable_styling()
```

4. Make a table comparing the per capita emissions of the US and the world's highest per capita emitter (from above)  in 1925, 1950, and 2014. 

The top emitter per capita is Qatar. We will create a data frame to compare Qatar and the USA. To help with adding data, we will convert the factors to character vectors.

```{r}
dat <- rep("NA", 3)
topEmitters <- data.frame("Qatar"=dat, "United.States"=dat)
row.names(topEmitters) <- c("1925", "1950", "2014")
topEmitters$Qatar <- as.character(topEmitters$Qatar)
topEmitters$United.States <- as.character(topEmitters$United.States)
topEmitters
```

From here, the challenge is subsetting the data and inserting it in the data frame.

```{r}
topEmitters[1,]<-gap_co2$X1925[c(139,184)]
topEmitters[2,]<-gap_co2$X1950[c(139,184)]
topEmitters[3,]<-gap_co2$X2014[c(139,184)]
topEmitters %>%
  kable() %>%
  kable_styling()
```

